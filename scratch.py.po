from pathlib import Path

from torch.utils.data import DataLoader

from timething import dataset, job, text, utils, align  # type: ignore

metadata = Path("/Users/purzelrakete/src/scratch/keanu/text.csv")
cfg = utils.load_config("english")
ds = dataset.SpeechDataset(Path(metadata), cfg.sampling_rate)
device = "cpu"
aligner = align.Aligner.build(device, cfg)
loader = DataLoader(
    ds,
    batch_size=1,
    num_workers=1,
    collate_fn=dataset.collate_fn,
    shuffle=False,
)
